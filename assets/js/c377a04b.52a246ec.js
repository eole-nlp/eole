"use strict";(self.webpackChunkdocusaurus_tsx=self.webpackChunkdocusaurus_tsx||[]).push([[5742],{4838:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>l,toc:()=>c});var s=i(4848),r=i(8453);const t={},o="EOLE",l={id:"index",title:"EOLE",description:"Documentation",source:"@site/docs/index.md",sourceDirName:".",slug:"/",permalink:"/eole/docs/",draft:!1,unlisted:!1,editUrl:"https://github.com/eole-nlp/eole/tree/main/docs/docs/index.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",next:{title:"Quickstart",permalink:"/eole/docs/quickstart"}},a={},c=[{value:"\ud83d\udc77\u200d\u2642\ufe0f\ud83d\udea7 Work in Progress",id:"\ufe0f-work-in-progress",level:2},{value:"Current State",id:"current-state",level:3},{value:"Future Directions",id:"future-directions",level:3},{value:"Key Features",id:"key-features",level:2},{value:"Setup",id:"setup",level:2},{value:"Using Docker",id:"using-docker",level:3},{value:"Installing Locally",id:"installing-locally",level:3},{value:"Requirements",id:"requirements",level:4},{value:"Installation from Source",id:"installation-from-source",level:4},{value:"Installation from PyPI",id:"installation-from-pypi",level:4},{value:"Notes",id:"notes",level:4},{value:"Manual Installation of Some Dependencies",id:"manual-installation-of-some-dependencies",level:3},{value:"Apex",id:"apex",level:4},{value:"Flash Attention",id:"flash-attention",level:4},{value:"AWQ",id:"awq",level:4},{value:"Contributing",id:"contributing",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"eole",children:"EOLE"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://eole-nlp.github.io/eole",children:(0,s.jsx)(n.img,{src:"https://img.shields.io/badge/docs-latest-blue.svg",alt:"Documentation"})})}),"\n",(0,s.jsxs)(n.p,{children:["Open language modeling toolkit based on ",(0,s.jsx)(n.a,{href:"https://pytorch.org",children:"PyTorch"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"\ufe0f-work-in-progress",children:"\ud83d\udc77\u200d\u2642\ufe0f\ud83d\udea7 Work in Progress"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://github.com/eole-nlp/eole",children:"EOLE"})," is a spin-off of the ",(0,s.jsx)(n.a,{href:"https://github.com/opennmt/opennmt-py",children:"OpenNMT-py"})," project. We aim to maintain the research-friendly approach of the original project while updating the structure and expanding it to include new topics related to large language models (LLMs) and various other techniques. Our goal is to provide a comprehensive yet compact and modular codebase for experimenting with various types of language models (encoder, decoder, seq2seq)."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"current-state",children:"Current State"}),"\n",(0,s.jsx)(n.p,{children:"We have made significant progress in several areas:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Configuration Management"}),": Streamlined through ",(0,s.jsx)(n.a,{href:"https://docs.pydantic.dev",children:"pydantic"})," models."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Command Line Entry Points"}),": Improved using structured subparsers for better organization."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Reproducible Recipes"}),": Provided for widely used models and tasks, ensuring consistency and reliability."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Core API Simplification"}),": Refined around the new configuration objects for ease of use."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"future-directions",children:"Future Directions"}),"\n",(0,s.jsx)(n.p,{children:"There are still several exciting avenues to explore:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Further Simplification and Refactoring"}),": Continue enhancing the codebase for clarity and efficiency."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Inference Server"}),": Develop a robust solution for model inference."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Additional Recipes"}),": Expand the library of reproducible recipes."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Documentation"}),": Enhance and expand the documentation for better user guidance."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Test Coverage"}),": Improve testing to ensure code reliability and performance."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Logging Enhancements"}),": Implement more sophisticated logging mechanisms."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Broader Model Support"}),": Extend support to include a wider range of open models, potentially multi-modal."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"key-features",children:"Key Features"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Versatile Training and Inference"}),": Train from scratch, finetune, and infer models of various architectures including Transformer Encoder/Decoder/EncoderDecoder and RNN EncoderDecoder."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Dynamic Data Transforms"}),": Apply on-the-fly transformations in the dataloading logic for both training and inference."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Comprehensive LLM Support"}),": Includes converters for Llama, Mistral, Phi, OpenLlama, Redpajama, MPT-7B, and Falcon models."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Advanced Quantization"}),": Support for 8-bit and 4-bit quantization, along with LoRA adapters, with or without checkpointing, as well as mixed precision (FP16)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Efficient Finetuning"}),": Finetune 7B and 13B models on a single RTX 24GB GPU using 4-bit quantization."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Flexible Inference"}),": Perform inference in 4-bit or 8-bit using the same layer quantization methods as in finetuning."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Tensor Parallelism"}),": Enable tensor parallelism for both training and inference when models exceed the memory capacity of a single GPU."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"setup",children:"Setup"}),"\n",(0,s.jsx)(n.h3,{id:"using-docker",children:"Using Docker"}),"\n",(0,s.jsxs)(n.p,{children:["To facilitate setup and reproducibility, we provide Docker images via the GitHub Container Registry: ",(0,s.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/pkgs/container/eole",children:"EOLE Docker Images"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["You can customize the workflow and build your own images based on specific needs using ",(0,s.jsx)(n.code,{children:"build.sh"})," and ",(0,s.jsx)(n.code,{children:"Dockerfile"})," in the ",(0,s.jsx)(n.code,{children:"docker"})," directory of the repository."]}),"\n",(0,s.jsx)(n.p,{children:"There are two images with CUDA 11.8 and 12.1 prebuilt, change the -cudaXX.X to your desired version when pulling the Docker images"}),"\n",(0,s.jsx)(n.p,{children:"To pull the Docker image:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker pull ghcr.io/eole-nlp/eole:0.0.1-torch2.3.0-ubuntu22.04-cuda12.1 \n"})}),"\n",(0,s.jsx)(n.p,{children:"Example one-liner to run a container and open a bash shell within it:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker run --rm -it --runtime=nvidia ghcr.io/eole-nlp/eole:0.0.1-torch2.3.0-ubuntu22.04-cuda12.1 \n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note"}),": Ensure you have the ",(0,s.jsx)(n.a,{href:"https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html",children:"Nvidia Container Toolkit"})," (formerly nvidia-docker) installed to take advantage of CUDA/GPU features."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Depending on your needs, you can add various flags:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"-p 5000:5000"}),": Forward an exposed port from your container to your host."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"-v /some/local/directory:/some/container/directory"}),": Mount a local directory to a container directory."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--entrypoint some_command"}),": Run a specific command as the container entry point (instead of the default bash shell)."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"installing-locally",children:"Installing Locally"}),"\n",(0,s.jsx)(n.h4,{id:"requirements",children:"Requirements"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Python >= 3.10"}),"\n",(0,s.jsx)(n.li,{children:"PyTorch >= 2.3 < 2.4"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"installation-from-source",children:"Installation from Source"}),"\n",(0,s.jsx)(n.p,{children:"To install from source:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/eole-nlp/eole\ncd eole\npip install -e .\n"})}),"\n",(0,s.jsx)(n.h4,{id:"installation-from-pypi",children:"Installation from PyPI"}),"\n",(0,s.jsx)(n.p,{children:"Installation from PyPI will be available soon."}),"\n",(0,s.jsx)(n.h4,{id:"notes",children:"Notes"}),"\n",(0,s.jsxs)(n.p,{children:["If you encounter a ",(0,s.jsx)(n.code,{children:"MemoryError"})," during installation, try using ",(0,s.jsx)(n.code,{children:"pip"})," with the ",(0,s.jsx)(n.code,{children:"--no-cache-dir"})," option."]}),"\n",(0,s.jsx)(n.p,{children:"(Optional) Some advanced features (e.g., pretrained models or specific transforms) require extra packages. Install them with:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"pip install -r requirements.opt.txt\n"})}),"\n",(0,s.jsx)(n.h3,{id:"manual-installation-of-some-dependencies",children:"Manual Installation of Some Dependencies"}),"\n",(0,s.jsx)(n.h4,{id:"apex",children:"Apex"}),"\n",(0,s.jsx)(n.p,{children:"Apex is recommended for improved performance, especially for the legacy fusedadam optimizer and FusedRMSNorm."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'git clone https://github.com/NVIDIA/apex\ncd apex\npip3 install -v --no-build-isolation --config-settings --build-option="--cpp_ext --cuda_ext --deprecated_fused_adam --xentropy --fast_multihead_attn" ./\ncd ..\n'})}),"\n",(0,s.jsx)(n.h4,{id:"flash-attention",children:"Flash Attention"}),"\n",(0,s.jsxs)(n.p,{children:["To use ",(0,s.jsx)(n.a,{href:"https://github.com/Dao-AILab/flash-attention#installation-and-features",children:"Flash Attention"}),", install it manually:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"pip install flash-attn --no-build-isolation\n"})}),"\n",(0,s.jsx)(n.h4,{id:"awq",children:"AWQ"}),"\n",(0,s.jsx)(n.p,{children:"For inference or quantizing an AWQ model, AutoAWQ is required. Install it with:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"pip install autoawq\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For more details, refer to ",(0,s.jsx)(n.a,{href:"https://github.com/casper-hansen/AutoAWQ",children:"AutoAWQ"}),"."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"contributing",children:"Contributing"}),"\n",(0,s.jsxs)(n.p,{children:["We love contributions! Please look at issues marked with the ",(0,s.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/issues?q=is%3Aissue+is%3Aopen+label%3A%22contributions+welcome%22",children:"contributions welcome"})," tag."]}),"\n",(0,s.jsxs)(n.p,{children:["Before raising an issue, make sure you read the requirements and the ",(0,s.jsx)(n.a,{href:"https://eole-nlp.github.io/eole",children:"Full Documentation"}),". You can also check if a ",(0,s.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/tree/main/recipes",children:"Recipe"})," fits your use case."]}),"\n",(0,s.jsxs)(n.p,{children:["Unless there is a bug, please use the ",(0,s.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/discussions",children:"Discussions"})," tab to ask questions or propose new topics/features."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>l});var s=i(6540);const r={},t=s.createContext(r);function o(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);